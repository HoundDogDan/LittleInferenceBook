
```{r echo = FALSE, message=FALSE}
# knitr hook to process the book into pdf
knitr::knit_hooks$set(document = function(x) {
  # Remove $$ from explicit equation environments 
  x <- gsub(pattern = "[$]{2}[\n ]*([\\]begin[^$]*)[$]{2}",
            replacement = "\\1",
            x = x)
  # Add non-breaking space after figures to disable captioning
  x <- gsub(pattern = "([!][[][^]]*[]][(][^)]*[)])",
            replacement = "\\1\\\\ ",
            x = x)
})
```

